import{_ as a,c as i,o as n,a2 as e}from"./chunks/framework.DxykYmMe.js";const l="/assets/9f4d46ac.D13u3fEo.png",t="/assets/462aeb92.DIYBC3q2.png",p="/assets/13cbe941.OpjgDx1a.png",h="/assets/be4c33bb.xt0a4KKq.png",r="/assets/352389fb.CKLfQEgS.png",o="/assets/da3431a0.ChyjkFOp.png",c="/assets/fabe482f.DaNGbYg9.png",d="/assets/2ebd89ab.oI36x67O.png",k="/assets/090332bb.Cbo-KZvR.png",g="/assets/a0129dc1.D8G_zhJ0.png",E=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"doc/blog/202403-阿里云运维实践.md","filePath":"doc/blog/202403-阿里云运维实践.md"}'),m={name:"doc/blog/202403-阿里云运维实践.md"};function _(y,s,F,u,b,x){return n(),i("div",null,s[0]||(s[0]=[e(`<h2 id="docker-images-推送" tabindex="-1">docker images 推送 <a class="header-anchor" href="#docker-images-推送" aria-label="Permalink to &quot;docker images 推送&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> login</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --username=demo@aliyun.com</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> registry.cn-shenzhen.aliyuncs.com</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># password</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tag</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {本地镜像ID或者本地镜像TAG}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {阿里云镜像TAG:registry.cn-shenzhen.aliyuncs.com/demo/myapp:latest}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> push</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {阿里云镜像TAG:registry.cn-shenzhen.aliyuncs.com/demo/myapp:latest}</span></span></code></pre></div><h2 id="k8s部署" tabindex="-1">k8s部署 <a class="header-anchor" href="#k8s部署" aria-label="Permalink to &quot;k8s部署&quot;">​</a></h2><ul><li>Deployment-菜单 <img src="`+l+'" alt="1"></li><li>Deployment-设置镜像 <img src="'+t+'" alt="2"></li><li>Deployment-容器端口/变量 <img src="'+p+'" alt="3"></li><li>Deployment-日志配置(关联 sls logstore) <img src="'+h+'" alt="4"></li><li>Service-菜单 <img src="'+r+'" alt="5"></li><li>Service-创建(负载均衡) <img src="'+o+'" alt="6"></li><li>Service-创建(负载均衡) <img src="'+c+'" alt="7"></li><li>Ingress-菜单 <img src="'+d+'" alt="8"></li><li>Ingress-创建 <img src="'+k+'" alt="9"></li></ul><h2 id="deployment更新" tabindex="-1">Deployment更新 <a class="header-anchor" href="#deployment更新" aria-label="Permalink to &quot;Deployment更新&quot;">​</a></h2><ol><li>安装<code>kubectl</code></li><li><code>{home}\\.kube</code> 下 创建 <code>config</code>文件</li><li>进入阿里云集群信息-连接信息-公网访问, 复制config内容</li><li>执行命令更新pod</li></ol><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> image</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> deployment/demo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> demo=registry-vpc.cn-shenzhen.aliyuncs.com/demo/myapp:latest</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> default</span></span></code></pre></div><h2 id="ssl证书" tabindex="-1">SSL证书 <a class="header-anchor" href="#ssl证书" aria-label="Permalink to &quot;SSL证书&quot;">​</a></h2><ul><li><p>Java使用JKS <a href="https://csr.chinassl.net/convert-ssl.html" target="_blank" rel="noreferrer">https://csr.chinassl.net/convert-ssl.html</a><img src="'+g+`" alt="1"></p></li><li><p>Nginx使用</p><div class="language-dockerfile vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">dockerfile</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nginx:1.24.0</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ./app/dist/ /usr/share/nginx/html/app</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> zkx.crt /home/zkx.crt</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ADD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> zkx.key /home/zkx.key</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nginx/conf/nginx.conf /etc/nginx/nginx.conf</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  server {</span></span>
<span class="line"><span>      listen   7443 ssl ;</span></span>
<span class="line"><span>      server_name  zkx.com;</span></span>
<span class="line"><span>      ssl_certificate /home/zkx_public.crt;</span></span>
<span class="line"><span>      ssl_certificate_key /home/zkx.key;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>      proxy_set_header Host $host;</span></span>
<span class="line"><span>      proxy_set_header X-Real-IP $remote_addr;</span></span>
<span class="line"><span>      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span></span>
<span class="line"><span>      location / {</span></span>
<span class="line"><span>          try_files $uri $uri/ /index.html;</span></span>
<span class="line"><span>          root   /usr/share/nginx/html/web/; </span></span>
<span class="line"><span>           index  index.html index.htm;</span></span>
<span class="line"><span>      }</span></span></code></pre></div></li></ul>`,9)]))}const f=a(m,[["render",_]]);export{E as __pageData,f as default};
